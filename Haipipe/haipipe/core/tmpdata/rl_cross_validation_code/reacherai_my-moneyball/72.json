{"seq": [{"operator": "ImputerMedian", "edge_id": "end"}, {"operator": "NumericData", "edge_id": "end"}, {"operator": "RobustScaler", "edge_id": "end"}, {"operator": "InteractionFeatures", "edge_id": "end"}], "code": "import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\nfrom sklearn import tree\ndf = pd.read_csv(r\"../input/baseball.csv\")\nimputer = SimpleImputer(missing_values=np.nan, strategy='constant', fill_value=0)\nimputer = imputer.fit(df[['RankSeason', 'RankPlayoffs', 'OOBP', 'OSLG']])\ndf[['RankSeason', 'RankPlayoffs', 'OOBP', 'OSLG']] = imputer.transform(df[['RankSeason', 'RankPlayoffs', 'OOBP', 'OSLG']])\ndf.League.replace(['NL', 'AL'], [1, 0], inplace=True)\ndf = df[df.columns.difference(['RankPlayoffs', 'Team'])]\ny = df[['Playoffs']]\ny = np.ravel(y)\nX = df[df.columns.difference(['Playoffs'])]\nfrom sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(X, y, train_size=0.8, test_size=1-0.8, random_state=0)\n\nfrom sklearn.preprocessing import RobustScaler\nimport pandas as pd\nimport numpy as np\ndef catch_num(data):\n    num_cols = [col for col in data.columns if str(data[col].dtypes) != 'object']\n    cat_cols = [col for col in data.columns if col not in num_cols]\n    cat_train_x = data[cat_cols]\n    num_train_x = data[num_cols]\n    return cat_train_x, num_train_x\n        \nadd_scaler = RobustScaler()\nX = pd.DataFrame(X).reset_index(drop=True).infer_objects()\ncat_train_x, num_train_x = catch_num(X)\nadd_scaler.fit(num_train_x)\nnum_train_x = pd.DataFrame(add_scaler.transform(num_train_x), columns=list(num_train_x.columns)).reset_index(drop=True).infer_objects()\nX = pd.concat([cat_train_x.reset_index(drop=True), num_train_x.reset_index(drop=True)],axis=1)\n        \n\nfrom sklearn.preprocessing import PolynomialFeatures\nimport pandas as pd\nimport numpy as np\n        \nX = pd.DataFrame(X).reset_index(drop=True).infer_objects()\nadd_engine = PolynomialFeatures(interaction_only=True, include_bias=False)\nadd_engine.fit(X)\ntrain_data_x = add_engine.transform(X)\ntrain_data_x = pd.DataFrame(train_data_x)\nX = train_data_x.loc[:, ~train_data_x.columns.duplicated()]\n        \nstd = StandardScaler()\nx_train = std.fit_transform(x_train)\nx_test = std.transform(x_test)\n#svc = SVC(kernel='linear').fit(x_train, y_train)\n#predictions = svc.predict(x_test)\n#print(predictions)\n#print(accuracy_score(y_test, predictions))\n#print(classification_report(y_test, predictions))\n\n\n\n\nimport pandas as pd\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.svm import SVC\n#print(\"start running model training........\")\nmodel = SVC(random_state=0)\nmodel.fit(x_train, y_train)\ny_pred = model.predict(x_test)\nscore = accuracy_score(y_test, y_pred)\nimport numpy as np\nnp.save(\"haipipe/core/tmpdata/merge_max_result_rl/reacherai_my-moneyball/72.npy\", { \"accuracy_score\": score })\n\n\n", "validation_code": "import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\nfrom sklearn import tree\ndf = pd.read_csv(r\"../input/baseball.csv\")\nimputer = SimpleImputer(missing_values=np.nan, strategy='constant', fill_value=0)\nimputer = imputer.fit(df[['RankSeason', 'RankPlayoffs', 'OOBP', 'OSLG']])\ndf[['RankSeason', 'RankPlayoffs', 'OOBP', 'OSLG']] = imputer.transform(df[['RankSeason', 'RankPlayoffs', 'OOBP', 'OSLG']])\ndf.League.replace(['NL', 'AL'], [1, 0], inplace=True)\ndf = df[df.columns.difference(['RankPlayoffs', 'Team'])]\ny = df[['Playoffs']]\ny = np.ravel(y)\nX = df[df.columns.difference(['Playoffs'])]\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(X, y, train_size=0.8, test_size=1-0.8, random_state=0)\n\nfrom sklearn.preprocessing import RobustScaler\nimport pandas as pd\nimport numpy as np\ndef catch_num(data):\n    num_cols = [col for col in data.columns if str(data[col].dtypes) != 'object']\n    cat_cols = [col for col in data.columns if col not in num_cols]\n    cat_train_x = data[cat_cols]\n    num_train_x = data[num_cols]\n    return cat_train_x, num_train_x\n        \nadd_scaler = RobustScaler()\nX = pd.DataFrame(X).reset_index(drop=True).infer_objects()\ncat_train_x, num_train_x = catch_num(X)\nadd_scaler.fit(num_train_x)\nnum_train_x = pd.DataFrame(add_scaler.transform(num_train_x), columns=list(num_train_x.columns)).reset_index(drop=True).infer_objects()\nX = pd.concat([cat_train_x.reset_index(drop=True), num_train_x.reset_index(drop=True)],axis=1)\n        \n\nfrom sklearn.preprocessing import PolynomialFeatures\nimport pandas as pd\nimport numpy as np\n        \nX = pd.DataFrame(X).reset_index(drop=True).infer_objects()\nadd_engine = PolynomialFeatures(interaction_only=True, include_bias=False)\nadd_engine.fit(X)\ntrain_data_x = add_engine.transform(X)\ntrain_data_x = pd.DataFrame(train_data_x)\nX = train_data_x.loc[:, ~train_data_x.columns.duplicated()]\n        \nstd = StandardScaler()\nx_train = std.fit_transform(x_train)\nx_test = std.transform(x_test)\n#svc = SVC(kernel='linear').fit(x_train, y_train)\n#predictions = svc.predict(x_test)\n#print(predictions)\n#print(accuracy_score(y_test, predictions))\n#print(classification_report(y_test, predictions))\n\n\n\n\nimport pandas as pd\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.svm import SVC\n#print(\"start running model training........\")\nmodel = SVC(random_state=0)\n#model.fit(x_train, y_train)\n#y_pred = model.predict(x_validation_varible)\n#score = accuracy_score(y_validation_varible, y_pred)\nfrom sklearn.model_selection import cross_val_score\ncross_score = cross_val_score(model, x_train, y_train,cv=4)\nimport numpy as np\n#np.save(\"haipipe/core/tmpdata/merge_max_result_rl/reacherai_my-moneyball/72.npy\", { \"accuracy_score\": score })\nnp.save(\"haipipe/core/tmpdata/rl_cross_val_res/reacherai_my-moneyball/72.npy\", { \"accuracy_score\": cross_score })\n\n\n\n"}